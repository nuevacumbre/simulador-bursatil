import{u as D,l as J,o as c,c as l,a as o,t as a,f as F,g as I,e as y,F as C,m as S,j as h,k as O,n as k}from"./index-D7JIC3SQ.js";const T=["AAPL","MSFT","GOOGL","AMZN","TSLA","META","NVDA","JPM","JNJ","WMT"],L="https://api.allorigins.win/raw?url=",E=async()=>{console.log("ðŸ“¡ Obteniendo datos reales de Yahoo Finance...");try{const n=T.map(async r=>{try{const m=`https://query1.finance.yahoo.com/v8/finance/chart/${r}?interval=1d`,_=`${L}${encodeURIComponent(m)}`,d=await fetch(_);if(!d.ok)throw new Error(`Error HTTP ${d.status}`);const b=(await d.json()).chart?.result?.[0],p=b?.meta,A=b?.indicators?.quote?.[0];if(!p||!A)throw new Error("Datos incompletos");const g=p.regularMarketPrice,v=p.previousClose,f=((g-v)/v*100).toFixed(2),M=await V(r);return{id:r,nombre:M,simbolo:r,precio:g,variacion:parseFloat(f),sector:N(r),timestamp:new Date().toISOString()}}catch(m){return console.error(`Error obteniendo ${r}:`,m),x(r)}}),i=await Promise.all(n);return console.log("âœ… Datos reales obtenidos:",i.length),i}catch(n){return console.error("âŒ Error en API:",n),T.map(i=>x(i))}},V=async n=>({AAPL:"Apple Inc.",MSFT:"Microsoft Corporation",GOOGL:"Alphabet Inc.",AMZN:"Amazon.com Inc.",TSLA:"Tesla Inc.",META:"Meta Platforms Inc.",NVDA:"NVIDIA Corporation",JPM:"JPMorgan Chase & Co.",JNJ:"Johnson & Johnson",WMT:"Walmart Inc."})[n]||n,N=n=>({AAPL:"TecnologÃ­a",MSFT:"TecnologÃ­a",GOOGL:"TecnologÃ­a",AMZN:"Consumo",TSLA:"Automotriz",META:"TecnologÃ­a",NVDA:"TecnologÃ­a",JPM:"Financiero",JNJ:"Salud",WMT:"Consumo"})[n]||"Otros",x=n=>{const r={AAPL:{nombre:"Apple Inc.",precio:175.5},MSFT:{nombre:"Microsoft",precio:420.3},GOOGL:{nombre:"Google",precio:145.8},AMZN:{nombre:"Amazon",precio:185.2},TSLA:{nombre:"Tesla",precio:240.15},META:{nombre:"Meta",precio:480.75},NVDA:{nombre:"NVIDIA",precio:950.2},JPM:{nombre:"JPMorgan",precio:185.5},JNJ:{nombre:"Johnson & Johnson",precio:160.3},WMT:{nombre:"Walmart",precio:65.4}}[n]||{nombre:n,precio:100};return{id:n,nombre:r.nombre,simbolo:n,precio:r.precio,variacion:parseFloat((Math.random()*10-5).toFixed(2)),sector:N(n),timestamp:new Date().toISOString()}},z={class:"container mt-4"},G={class:"row mb-4"},R={class:"col"},$={class:"d-flex justify-content-between align-items-center"},B={class:"text-muted"},W=["disabled"],j={key:0,class:"spinner-border spinner-border-sm me-2"},Y={key:0,class:"text-center my-5"},Z={key:1},q={class:"row"},U={class:"card h-100 shadow-sm"},H={class:"card-body"},X={class:"d-flex justify-content-between align-items-start"},K={class:"card-title mb-0"},Q={class:"badge bg-secondary"},oo={class:"mt-2"},eo={class:"row text-center"},to={class:"col-6"},so={class:"h5"},no={class:"col-6"},ro={class:"d-grid gap-2"},ao=["onClick"],io=["onClick"],co={class:"row mt-5"},lo={class:"col"},uo={class:"card"},mo={class:"card-body"},po={key:0,class:"text-center text-muted py-3"},bo={key:1,class:"list-group list-group-flush"},go={class:"text-muted ms-2"},ho={class:"badge bg-primary rounded-pill"},vo={__name:"Dashboard",setup(n){const i=D(),r=O(),m=h([]),_=h(!0),d=h(!1),u=h([]),b=h(""),p=t=>new Intl.NumberFormat("es-CR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(t),A=t=>({TecnologÃ­a:"bg-primary",Consumo:"bg-success",Automotriz:"bg-warning text-dark",Financiero:"bg-info text-dark",Salud:"bg-danger"})[t]||"bg-secondary",g=async()=>{try{const t=await E();t&&t.length>0?(m.value=t,b.value=new Date().toLocaleTimeString(),console.log("ðŸ“Š Activos cargados:",t.length,"primer activo:",t[0])):console.warn("No se obtuvieron datos")}catch(t){console.error("Error cargando datos:",t),m.value=T.map(e=>x(e))}finally{_.value=!1,d.value=!1}},v=async()=>{d.value=!0,await g()},f=async()=>{await i.logout(),r.push({name:"login"})},M=t=>{const e=u.value.find(s=>s.nombre===t.nombre);e?(e.cantidad+=1,e.total=e.cantidad*t.precio):u.value.push({nombre:t.nombre,cantidad:1,total:t.precio})},P=t=>{const e=u.value.find(s=>s.nombre===t.nombre);e&&e.cantidad>0&&(e.cantidad-=1,e.cantidad===0?u.value=u.value.filter(s=>s.nombre!==t.nombre):e.total=e.cantidad*t.precio)};return J(()=>{g()}),(t,e)=>(c(),l("div",z,[o("div",G,[o("div",R,[o("div",$,[o("div",null,[o("h2",null,"Bienvenido, "+a(F(i).userEmail),1),o("small",B," Ãšltima actualizaciÃ³n: "+a(b.value),1)]),o("div",null,[o("button",{onClick:v,class:"btn btn-outline-primary me-2",disabled:d.value},[d.value?(c(),l("span",j)):I("",!0),y(" "+a(d.value?"Actualizando...":"ðŸ”„ Actualizar"),1)],8,W),o("button",{onClick:f,class:"btn btn-danger"},[...e[0]||(e[0]=[o("i",{class:"bi bi-box-arrow-right"},null,-1),y(" Cerrar SesiÃ³n ",-1)])])])])])]),_.value?(c(),l("div",Y,[...e[1]||(e[1]=[o("div",{class:"spinner-border text-primary",style:{width:"3rem",height:"3rem"},role:"status"},[o("span",{class:"visually-hidden"},"Cargando datos del mercado...")],-1),o("p",{class:"mt-2"},"Obteniendo datos en tiempo real de Yahoo Finance...",-1)])])):(c(),l("div",Z,[e[6]||(e[6]=o("h3",{class:"mb-3"},"Mercado en Tiempo Real",-1)),o("div",q,[(c(!0),l(C,null,S(m.value,s=>(c(),l("div",{key:s.id,class:"col-md-4 mb-3"},[o("div",U,[o("div",H,[o("div",X,[o("h5",K,a(s.nombre),1),o("span",Q,a(s.simbolo),1)]),o("div",oo,[o("span",{class:k(["badge",A(s.sector)])},a(s.sector),3)]),e[4]||(e[4]=o("hr",null,null,-1)),o("div",eo,[o("div",to,[e[2]||(e[2]=o("small",{class:"text-muted d-block"},"Precio",-1)),o("strong",so,"$"+a(p(s.precio)),1)]),o("div",no,[e[3]||(e[3]=o("small",{class:"text-muted d-block"},"VariaciÃ³n",-1)),o("strong",{class:k(s.variacion>=0?"text-success":"text-danger")},a(s.variacion>=0?"+":"")+a(s.variacion)+"% ",3)])]),e[5]||(e[5]=o("hr",null,null,-1)),o("div",ro,[o("button",{onClick:w=>M(s),class:"btn btn-success btn-sm"}," Comprar ",8,ao),o("button",{onClick:w=>P(s),class:"btn btn-warning btn-sm"},"Vender",8,io)])])])]))),128))])])),o("div",co,[o("div",lo,[e[7]||(e[7]=o("h3",null,"Mi Portafolio",-1)),o("div",uo,[o("div",mo,[u.value.length===0?(c(),l("div",po," No tienes activos en tu cartera. Â¡Empieza a invertir! ")):(c(),l("ul",bo,[(c(!0),l(C,null,S(u.value,(s,w)=>(c(),l("li",{key:w,class:"list-group-item d-flex justify-content-between align-items-center"},[o("div",null,[o("strong",null,a(s.nombre),1),o("small",go,"("+a(s.cantidad)+" acciones)",1)]),o("span",ho,"$"+a(p(s.total)),1)]))),128))]))])])])])]))}};export{vo as default};
